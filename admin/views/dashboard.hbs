<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Dashboard - CivicConnect</title>
  <link rel="icon" type="image/png" href="/images/favicon.png" />
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png" />
  <link rel="apple-touch-icon" href="/images/favicon.png" />
  <style>
    :root{ 
      --bg-1:#0f172a; --accent:#06b6d4; --accent-2:#0ea5a4; --muted:#94a3b8; 
      --radius:14px; --shadow:0 10px 30px rgba(2,6,23,0.12);
      --success:#10b981; --warning:#f59e0b; --danger:#ef4444; --info:#3b82f6;
      --glass: rgba(255,255,255,0.65); --border: rgba(15,23,42,0.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Helvetica,Arial;background:
      radial-gradient(1200px 400px at 10% 10%, rgba(6,182,212,0.04), transparent),
      radial-gradient(800px 300px at 90% 20%, rgba(16,185,129,0.03), transparent),
      linear-gradient(180deg,#f5f7fb,#eef2f6);color:var(--bg-1)}
    .wrap{width:100vw;height:100vh;display:flex;align-items:stretch;justify-content:center;padding:20px;gap:20px;position:relative;overflow:hidden}
    
    /* Animated background orbs */
    .bg-ornaments{position:absolute;inset:0;pointer-events:none;z-index:0}
    .orb{position:absolute;filter:blur(60px);opacity:0.2;animation:float 20s ease-in-out infinite}
    .orb.one{width:300px;height:300px;background:radial-gradient(circle at 30% 30%, #67e8f9, transparent 60%);top:-100px;left:-100px}
    .orb.two{width:400px;height:400px;background:radial-gradient(circle at 70% 40%, #a7f3d0, transparent 60%);bottom:-150px;right:-150px;animation-delay:5s}
    @keyframes float{0%,100%{transform:translateY(0) translateX(0)}50%{transform:translateY(20px) translateX(-15px)}}
    
    .grid-layout{display:grid;grid-template-columns:280px 1fr;gap:22px;align-items:start;width:100%;height:100%;max-width:none;position:relative;z-index:1}
    
    /* Enhanced Sidebar */
    .sidebar{display:flex;flex-direction:column;gap:12px;padding:20px;border-radius:var(--radius);background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.94));box-shadow:var(--shadow);border:1px solid rgba(15,23,42,0.03);height:100%;overflow:auto;position:relative;top:0;z-index:5;backdrop-filter:blur(8px)}
    .sidebar::before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--accent),var(--accent-2),var(--success))}
    
    .profile{display:flex;gap:12px;align-items:center;padding:12px;border-radius:12px;background:linear-gradient(135deg,rgba(6,182,212,0.05),rgba(14,165,164,0.05));border:1px solid rgba(6,182,212,0.1)}
    .avatar{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,#ecfeff,#dbeafe);display:flex;align-items:center;justify-content:center;font-weight:800;color:#0f172a;font-size:22px;box-shadow:0 8px 20px rgba(6,182,212,0.06);position:relative;overflow:hidden}
    .avatar::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,transparent 30%,rgba(255,255,255,0.3) 50%,transparent 70%);animation:shimmer 3s ease-in-out infinite}
    @keyframes shimmer{0%,100%{opacity:0}50%{opacity:1}}
    .userMeta .name{font-weight:800;font-size:16px;background:linear-gradient(45deg,var(--accent),var(--accent-2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .userMeta .email{font-size:13px;color:var(--muted);margin-top:4px}
    .userMeta .status{font-size:11px;color:var(--success);font-weight:600;margin-top:2px;display:flex;align-items:center;gap:4px}
    .userMeta .status::before{content:"‚óè";animation:pulse 2s ease-in-out infinite}
    
    .nav{display:flex;flex-direction:column;gap:6px;margin-top:16px}
    .nav a{display:flex;align-items:center;gap:12px;padding:12px;border-radius:12px;color:var(--bg-1);text-decoration:none;font-weight:700;transition:all .3s ease;position:relative;overflow:hidden}
    .nav a::before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,var(--accent),var(--accent-2));opacity:0;transition:opacity .3s ease}
    .nav a.active{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;box-shadow:0 8px 22px rgba(14,165,164,0.12)}
    .nav a.active::before{opacity:1}
    .nav a:hover{background:rgba(6,182,212,0.08);transform:translateX(4px)}
    .nav a:hover::before{opacity:1}
    .nav-icon{font-size:16px;width:20px;text-align:center}
    
    .small{font-size:13px;color:var(--muted);margin-top:auto;padding:12px;background:rgba(15,23,42,0.02);border-radius:8px;text-align:center}
    
    /* Enhanced Main Area */
    .main{display:flex;flex-direction:column;gap:18px;height:100%;overflow:hidden;border-radius:var(--radius)}
    .mainInner{display:flex;flex-direction:column;padding:20px;background:linear-gradient(180deg,rgba(255,255,255,0.98),#fff);box-shadow:var(--shadow);border:1px solid rgba(15,23,42,0.03);height:100%;overflow:auto;border-radius:var(--radius);position:relative}
    .mainInner::before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--accent),var(--accent-2))}
    
    /* Enhanced Topbar */
    .topbar{display:flex;justify-content:space-between;align-items:center;gap:12px;position:relative;top:0;padding:16px 0;z-index:10;background:linear-gradient(180deg,rgba(255,255,255,0.98),#fff);backdrop-filter:saturate(140%) blur(6px);border-bottom:1px solid rgba(15,23,42,0.06);margin-bottom:8px}
    .title h1{margin:0;font-size:24px;font-weight:800;background:linear-gradient(45deg,var(--accent),var(--accent-2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .sub{color:var(--muted);font-size:14px;margin-top:4px}
    
    /* Logo Styles */
    .logo-container{display:flex;align-items:center;gap:12px}
    .admin-logo{width:40px;height:40px;object-fit:contain;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1)}
    .logo-text{display:flex;flex-direction:column;gap:2px}
    
    /* Notification Bell */
    .notifications{position:relative;cursor:pointer}
    .bell{font-size:20px;color:var(--muted);transition:all .3s ease}
    .bell:hover{color:var(--accent);transform:scale(1.1)}
    .bell-badge{position:absolute;top:-8px;right:-8px;background:var(--danger);color:white;border-radius:50%;width:18px;height:18px;font-size:10px;display:flex;align-items:center;justify-content:center;font-weight:700;animation:pulse 2s ease-in-out infinite}
    
    /* Notifications Dropdown */
    .notifications-dropdown{position:absolute;top:100%;right:0;width:320px;background:linear-gradient(180deg,rgba(255,255,255,0.98),#fff);backdrop-filter:blur(12px);border-radius:16px;box-shadow:0 20px 60px rgba(2,6,23,0.15);border:1px solid rgba(15,23,42,0.08);z-index:1000;opacity:0;visibility:hidden;transform:translateY(-10px);transition:all .3s ease;margin-top:8px}
    .notifications-dropdown.show{opacity:1;visibility:visible;transform:translateY(0)}
    .notifications-dropdown::before{content:"";position:absolute;top:-8px;right:20px;width:16px;height:16px;background:linear-gradient(180deg,rgba(255,255,255,0.98),#fff);border:1px solid rgba(15,23,42,0.08);border-bottom:none;border-right:none;transform:rotate(45deg)}
    
    .notifications-header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid rgba(15,23,42,0.06)}
    .notifications-title{font-size:16px;font-weight:700;color:var(--bg-1);margin:0}
    .notifications-actions{display:flex;gap:8px}
    .notifications-btn{background:none;border:none;color:var(--accent);font-size:12px;font-weight:600;cursor:pointer;padding:4px 8px;border-radius:6px;transition:all .3s ease}
    .notifications-btn:hover{background:rgba(6,182,212,0.1)}
    
    .notifications-list{max-height:400px;overflow-y:auto;padding:8px 0}
    .notifications-list::-webkit-scrollbar{width:4px}
    .notifications-list::-webkit-scrollbar-track{background:rgba(15,23,42,0.05);border-radius:2px}
    .notifications-list::-webkit-scrollbar-thumb{background:var(--accent);border-radius:2px}
    
    .notification-item{display:flex;gap:12px;padding:12px 20px;border-bottom:1px solid rgba(15,23,42,0.04);transition:all .3s ease;cursor:pointer;position:relative}
    .notification-item:hover{background:rgba(6,182,212,0.05)}
    .notification-item.unread{background:rgba(6,182,212,0.02);border-left:3px solid var(--accent)}
    .notification-item.unread::before{content:"";position:absolute;left:8px;top:50%;transform:translateY(-50%);width:6px;height:6px;background:var(--accent);border-radius:50%}
    
    .notification-icon{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:white;flex-shrink:0}
    .notification-icon.success{background:var(--success)}
    .notification-icon.warning{background:var(--warning)}
    .notification-icon.danger{background:var(--danger)}
    .notification-icon.info{background:var(--info)}
    .notification-icon.system{background:var(--accent)}
    
    .notification-content{flex:1;min-width:0}
    .notification-title{font-weight:600;font-size:14px;color:var(--bg-1);margin-bottom:4px;line-height:1.3}
    .notification-message{font-size:13px;color:var(--muted);line-height:1.4;margin-bottom:4px}
    .notification-time{font-size:11px;color:var(--muted);font-weight:500}
    
    .notification-actions{display:flex;gap:4px;margin-top:8px}
    .notification-action{background:none;border:1px solid rgba(15,23,42,0.1);color:var(--muted);font-size:11px;padding:4px 8px;border-radius:4px;cursor:pointer;transition:all .3s ease}
    .notification-action:hover{background:var(--accent);color:white;border-color:var(--accent)}
    
    .notifications-footer{padding:12px 20px;border-top:1px solid rgba(15,23,42,0.06);text-align:center}
    .notifications-footer-btn{background:var(--accent);color:white;border:none;padding:8px 16px;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;transition:all .3s ease}
    .notifications-footer-btn:hover{background:var(--accent-2);transform:translateY(-1px)}
    
    /* Enhanced Buttons */
    .btn{padding:12px 18px;border-radius:12px;border:0;cursor:pointer;font-weight:800;font-size:14px;transition:all .3s ease;position:relative;overflow:hidden}
    .btn::before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.2),transparent);transition:left .5s ease}
    .btn:hover::before{left:100%}
    .btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;box-shadow:0 10px 30px rgba(6,182,212,0.12)}
    .btn-primary:hover{transform:translateY(-2px);box-shadow:0 15px 40px rgba(6,182,212,0.25)}
    .btn-ghost{background:transparent;border:2px solid rgba(15,23,42,0.06);color:var(--bg-1)}
    .btn-ghost:hover{background:rgba(6,182,212,0.05);border-color:var(--accent);transform:translateY(-1px)}
    .btn-danger{background:linear-gradient(90deg,var(--danger),#dc2626);color:white;box-shadow:0 8px 20px rgba(239,68,68,0.12)}
    .btn-danger:hover{transform:translateY(-2px);box-shadow:0 12px 30px rgba(239,68,68,0.25)}
    
    /* Enhanced Stats */
    .stats{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-top:8px}
    .stat-card{border-radius:16px;padding:20px;background:linear-gradient(180deg,rgba(255,255,255,0.95),#fff);box-shadow:0 12px 40px rgba(2,6,23,0.04);border:1px solid rgba(15,23,42,0.03);position:relative;overflow:hidden;transition:all .3s ease}
    .stat-card::before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--accent),var(--accent-2))}
    .stat-card:hover{transform:translateY(-4px);box-shadow:0 20px 50px rgba(2,6,23,0.08)}
    .stat-card .label{font-size:13px;color:var(--muted);font-weight:600;text-transform:uppercase;letter-spacing:0.5px}
    .stat-card .value{font-size:28px;font-weight:900;margin-top:8px;background:linear-gradient(45deg,var(--accent),var(--accent-2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .stat-card .trend{font-size:12px;margin-top:4px;font-weight:600;display:flex;align-items:center;gap:4px}
    .stat-card .trend.up{color:var(--success)}
    .stat-card .trend.down{color:var(--danger)}
    
     /* Enhanced Charts */
     .charts{display:grid;grid-template-columns:2fr 1fr;gap:16px;margin-top:8px}
     .chart-card{border-radius:16px;padding:20px;background:linear-gradient(180deg,rgba(255,255,255,0.98),#fff);box-shadow:0 12px 30px rgba(2,6,23,0.04);border:1px solid rgba(15,23,42,0.03);position:relative;overflow:hidden;display:flex;flex-direction:column;min-height:280px}
     .chart-card::before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--accent),var(--accent-2))}
     .chart-title{margin:0 0 16px 0;font-size:16px;color:var(--bg-1);font-weight:700}
     .chart-card canvas{flex:1;max-height:200px;width:100% !important;height:200px !important}
    
    /* Activity Feed Card Specific */
    .activity-card{min-height:400px;height:400px}
    
    /* Activity Feed */
    .activity-feed{height:calc(100% - 60px);overflow-y:auto;padding-right:8px;display:flex;flex-direction:column;gap:8px}
    .activity-feed::-webkit-scrollbar{width:4px}
    .activity-feed::-webkit-scrollbar-track{background:rgba(15,23,42,0.05);border-radius:2px}
    .activity-feed::-webkit-scrollbar-thumb{background:var(--accent);border-radius:2px}
    .activity-item{display:flex;gap:12px;padding:12px;border-radius:12px;background:rgba(255,255,255,0.5);border:1px solid rgba(15,23,42,0.06);transition:all .3s ease;flex-shrink:0}
    .activity-item:hover{background:rgba(6,182,212,0.05);transform:translateX(4px)}
    .activity-icon{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:white;flex-shrink:0}
    .activity-icon.success{background:var(--success)}
    .activity-icon.warning{background:var(--warning)}
    .activity-icon.danger{background:var(--danger)}
    .activity-icon.info{background:var(--info)}
    .activity-content{flex:1}
    .activity-title{font-weight:700;font-size:14px;margin-bottom:4px}
    .activity-meta{font-size:12px;color:var(--muted)}
    .activity-time{font-size:11px;color:var(--muted);margin-top:4px}
    
    /* System Status */
    .system-status{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:16px}
    .status-item{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:10px;background:rgba(255,255,255,0.5);border:1px solid rgba(15,23,42,0.06)}
    .status-label{font-size:13px;font-weight:600;color:var(--bg-1)}
    .status-indicator{width:8px;height:8px;border-radius:50%;animation:pulse 2s ease-in-out infinite}
    .status-indicator.online{background:var(--success)}
    .status-indicator.warning{background:var(--warning)}
    .status-indicator.offline{background:var(--danger)}
    
     .afterTopbar{padding-top:8px}
     
     /* Footer Styles */
     .footer{background:linear-gradient(180deg,rgba(15,23,42,0.95),rgba(15,23,42,0.98));backdrop-filter:blur(12px);border-top:1px solid rgba(255,255,255,0.1);margin-top:40px;position:relative;z-index:10;width:100%}
     .footer-content{display:grid;grid-template-columns:repeat(4,1fr);gap:32px;padding:40px 20px;max-width:1200px;margin:0 auto}
     .footer-section h4{color:white;font-size:18px;font-weight:800;margin:0 0 12px 0;background:linear-gradient(45deg,var(--accent),var(--accent-2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
     .footer-section h5{color:white;font-size:14px;font-weight:700;margin:0 0 16px 0;text-transform:uppercase;letter-spacing:0.5px}
     .footer-section p{color:var(--muted);font-size:14px;margin:0 0 16px 0;line-height:1.5}
     .social-links{display:flex;gap:12px}
     .social-link{display:flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:8px;background:rgba(255,255,255,0.1);color:white;text-decoration:none;font-size:16px;transition:all .3s ease;border:1px solid rgba(255,255,255,0.1)}
     .social-link:hover{background:rgba(6,182,212,0.2);border-color:var(--accent);transform:translateY(-2px)}
     .footer-links{list-style:none;padding:0;margin:0}
     .footer-links li{margin-bottom:8px}
     .footer-links a{color:var(--muted);text-decoration:none;font-size:14px;transition:color .3s ease}
     .footer-links a:hover{color:var(--accent)}
     .system-info{display:flex;flex-direction:column;gap:8px}
     .info-item{display:flex;justify-content:space-between;align-items:center;padding:6px 0}
     .info-item .label{color:var(--muted);font-size:12px;font-weight:600}
     .info-item .value{color:white;font-size:12px;font-weight:700}
     .info-item .value.online{color:var(--success)}
     .footer-bottom{background:rgba(0,0,0,0.2);border-top:1px solid rgba(255,255,255,0.05);padding:20px}
     .footer-bottom-content{display:flex;justify-content:space-between;align-items:center;max-width:1200px;margin:0 auto;padding:0 20px}
     .footer-bottom p{color:var(--muted);font-size:12px;margin:0}
     .footer-bottom-links{display:flex;gap:20px}
     .footer-bottom-links a{color:var(--muted);text-decoration:none;font-size:12px;transition:color .3s ease}
     .footer-bottom-links a:hover{color:var(--accent)}
     
     /* Responsive Design */
    @media (max-width:1200px){
      .grid-layout{grid-template-columns:240px 1fr;gap:16px}
      .stats{grid-template-columns:repeat(2,1fr)}
      .charts{grid-template-columns:1fr}
    }
    
     @media (max-width:768px){
       .grid-layout{grid-template-columns:1fr;gap:12px}
       .sidebar{position:static;height:auto}
       .stats{grid-template-columns:1fr}
       .system-status{grid-template-columns:1fr}
       .footer-content{grid-template-columns:repeat(2,1fr);gap:24px;padding:32px 20px}
       .footer-bottom-content{flex-direction:column;gap:12px;text-align:center}
       .footer-bottom-links{justify-content:center}
     }
     @media (max-width:480px){
       .footer-content{grid-template-columns:1fr;gap:20px;padding:24px 16px}
       .footer-section{text-align:center}
       .social-links{justify-content:center}
     }
    
    @media (prefers-reduced-motion:reduce){
      .orb, .bell-badge, .status-indicator{animation:none}
      .btn, .stat-card, .activity-item{transition:none}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Animated Background Ornaments -->
    <div class="bg-ornaments">
      <div class="orb one"></div>
      <div class="orb two"></div>
    </div>
    
    <div class="grid-layout">
      <aside class="sidebar">
        <div class="profile">
          <div class="avatar">{{username.[0]}}</div>
          <div class="userMeta">
            <div class="name">{{username}}</div>
            <div class="email">System Administrator</div>
            <div class="status">Online</div>
          </div>
        </div>
        <nav class="nav">
          <a href="/admin" class="active">
            <span class="nav-icon">üìä</span>
            <span>Overview</span>
          </a>
          <a href="/admin/users">
            <span class="nav-icon">üë•</span>
            <span>Users</span>
          </a>
          <a href="/admin/reports">
            <span class="nav-icon">üìã</span>
            <span>Reports</span>
          </a>
          <a href="/admin/settings">
            <span class="nav-icon">‚öôÔ∏è</span>
            <span>Settings</span>
          </a>
        </nav>
        <div class="small">CivicConnect Admin v2.1</div>
      </aside>

      <main class="main">
        <div class="mainInner">
          <div class="topbar">
            <div class="title">
              <div class="logo-container">
                <img src="/images/logo-mainpage.png" alt="CivicConnect Logo" class="admin-logo">
                <div class="logo-text">
                  <h1>Admin Dashboard</h1>
                  <div class="sub">Real-time platform monitoring & management</div>
                </div>
              </div>
            </div>
            <div style="display:flex;gap:12px;align-items:center">
              <div class="notifications" onclick="toggleNotifications()">
                <span class="bell">üîî</span>
                <span class="bell-badge">5</span>
                <div class="notifications-dropdown" id="notificationsDropdown">
                  <div class="notifications-header">
                    <h3 class="notifications-title">Notifications</h3>
                    <div class="notifications-actions">
                      <button class="notifications-btn" onclick="markAllAsRead()">Mark all read</button>
                      <button class="notifications-btn" onclick="clearAllNotifications()">Clear all</button>
                    </div>
                  </div>
                  <div class="notifications-list">
                    <div class="notification-item unread" onclick="handleNotificationClick(this, 'report')">
                      <div class="notification-icon success">üìã</div>
                      <div class="notification-content">
                        <div class="notification-title">New Report Submitted</div>
                        <div class="notification-message">Road pothole reported in downtown area by John Doe</div>
                        <div class="notification-time">2 minutes ago</div>
                        <div class="notification-actions">
                          <button class="notification-action" onclick="event.stopPropagation(); viewReport('1234')">View</button>
                          <button class="notification-action" onclick="event.stopPropagation(); markAsRead(this)">Mark read</button>
                        </div>
                      </div>
                    </div>
                    <div class="notification-item unread" onclick="handleNotificationClick(this, 'system')">
                      <div class="notification-icon warning">‚ö†Ô∏è</div>
                      <div class="notification-content">
                        <div class="notification-title">SLA Breach Alert</div>
                        <div class="notification-message">Report #1234 exceeded 24h response time</div>
                        <div class="notification-time">15 minutes ago</div>
                        <div class="notification-actions">
                          <button class="notification-action" onclick="event.stopPropagation(); viewReport('1234')">View</button>
                          <button class="notification-action" onclick="event.stopPropagation(); markAsRead(this)">Mark read</button>
                        </div>
                      </div>
                    </div>
                    <div class="notification-item" onclick="handleNotificationClick(this, 'user')">
                      <div class="notification-icon info">üë§</div>
                      <div class="notification-content">
                        <div class="notification-title">New User Registration</div>
                        <div class="notification-message">jane.smith@example.com joined the platform</div>
                        <div class="notification-time">1 hour ago</div>
                        <div class="notification-actions">
                          <button class="notification-action" onclick="event.stopPropagation(); viewUser('jane.smith')">View</button>
                          <button class="notification-action" onclick="event.stopPropagation(); markAsRead(this)">Mark read</button>
                        </div>
                      </div>
                    </div>
                    <div class="notification-item" onclick="handleNotificationClick(this, 'system')">
                      <div class="notification-icon system">üîß</div>
                      <div class="notification-content">
                        <div class="notification-title">System Maintenance</div>
                        <div class="notification-message">Database optimization scheduled for 2:00 AM</div>
                        <div class="notification-time">2 hours ago</div>
                        <div class="notification-actions">
                          <button class="notification-action" onclick="event.stopPropagation(); viewSystemStatus()">View</button>
                          <button class="notification-action" onclick="event.stopPropagation(); markAsRead(this)">Mark read</button>
                        </div>
                      </div>
                    </div>
                    <div class="notification-item" onclick="handleNotificationClick(this, 'report')">
                      <div class="notification-icon success">‚úÖ</div>
                      <div class="notification-content">
                        <div class="notification-title">Report Resolved</div>
                        <div class="notification-message">Issue #1230 marked as completed by admin</div>
                        <div class="notification-time">3 hours ago</div>
                        <div class="notification-actions">
                          <button class="notification-action" onclick="event.stopPropagation(); viewReport('1230')">View</button>
                          <button class="notification-action" onclick="event.stopPropagation(); markAsRead(this)">Mark read</button>
                        </div>
                      </div>
                    </div>
                    <div class="notification-item" onclick="handleNotificationClick(this, 'system')">
                      <div class="notification-icon danger">üö®</div>
                      <div class="notification-content">
                        <div class="notification-title">High Priority Alert</div>
                        <div class="notification-message">Server CPU usage above 90%</div>
                        <div class="notification-time">4 hours ago</div>
                        <div class="notification-actions">
                          <button class="notification-action" onclick="event.stopPropagation(); viewSystemStatus()">View</button>
                          <button class="notification-action" onclick="event.stopPropagation(); markAsRead(this)">Mark read</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="notifications-footer">
                    <button class="notifications-footer-btn" onclick="location.href='/admin/notifications'">View All Notifications</button>
                  </div>
                </div>
              </div>
              <button class="btn btn-primary" onclick="location.href='/admin/settings'">‚öôÔ∏è Settings</button>
              <button class="btn btn-danger" onclick="location.href='/admin/logout'">üö™ Logout</button>
            </div>
          </div>

          <div class="afterTopbar">
          <section class="stats">
            <div class="stat-card">
              <div class="label">Total Users</div>
              <div class="value">{{usersCount}}</div>
              <div class="trend up">‚Üó +12% this month</div>
            </div>
            <div class="stat-card">
              <div class="label">Active Reports</div>
              <div class="value">{{reportsCount}}</div>
              <div class="trend up">‚Üó +8% this week</div>
            </div>
            <div class="stat-card">
              <div class="label">Open Issues</div>
              <div class="value">{{openCount}}</div>
              <div class="trend down">‚Üò -5% today</div>
            </div>
            <div class="stat-card">
              <div class="label">Resolved</div>
              <div class="value">{{resolvedCount}}</div>
              <div class="trend up">‚Üó +15% this week</div>
            </div>
          </section>

           <section class="charts" aria-label="Analytics">
             <div class="chart-card">
               <h3 class="chart-title">Incident trend (last 12 weeks)</h3>
               <canvas id="trendChart"></canvas>
             </div>
             <div class="chart-card">
               <h3 class="chart-title">SLA compliance</h3>
               <canvas id="slaChart"></canvas>
             </div>
           </section>

           <section class="charts" aria-label="Operational mix">
             <div class="chart-card">
               <h3 class="chart-title">Status distribution</h3>
               <canvas id="statusChart"></canvas>
             </div>
             <div class="chart-card">
               <h3 class="chart-title">Category mix</h3>
               <canvas id="categoryChart"></canvas>
             </div>
           </section>

          <section style="margin-top:8px;display:grid;grid-template-columns:2fr 1fr;gap:16px">
            <!-- Activity Feed -->
            <div class="chart-card activity-card">
              <h3 class="chart-title">Recent Activity</h3>
              <div class="sub">System events, user actions, and alerts</div>
              <div class="activity-feed">
                <div class="activity-item">
                  <div class="activity-icon success">‚úì</div>
                  <div class="activity-content">
                    <div class="activity-title">New user registered</div>
                    <div class="activity-meta">john.doe@example.com joined the platform</div>
                    <div class="activity-time">2 minutes ago</div>
                  </div>
                </div>
                <div class="activity-item">
                  <div class="activity-icon warning">‚ö†</div>
                  <div class="activity-content">
                    <div class="activity-title">SLA breach detected</div>
                    <div class="activity-meta">Report #1234 exceeded 24h response time</div>
                    <div class="activity-time">15 minutes ago</div>
                  </div>
                </div>
                <div class="activity-item">
                  <div class="activity-icon info">‚Ñπ</div>
                  <div class="activity-content">
                    <div class="activity-title">System maintenance scheduled</div>
                    <div class="activity-meta">Database optimization at 2:00 AM</div>
                    <div class="activity-time">1 hour ago</div>
                  </div>
                </div>
                <div class="activity-item">
                  <div class="activity-icon success">‚úì</div>
                  <div class="activity-content">
                    <div class="activity-title">Report resolved</div>
                    <div class="activity-meta">Issue #1230 marked as completed</div>
                    <div class="activity-time">2 hours ago</div>
                  </div>
                </div>
                <div class="activity-item">
                  <div class="activity-icon danger">!</div>
                  <div class="activity-content">
                    <div class="activity-title">High priority alert</div>
                    <div class="activity-meta">Server CPU usage above 90%</div>
                    <div class="activity-time">3 hours ago</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Quick Actions & System Status -->
            <div style="display:flex;flex-direction:column;gap:16px">
              <div class="chart-card">
                <h3 class="chart-title">Quick Actions</h3>
                <div style="display:flex;flex-direction:column;gap:10px">
                  <button class="btn btn-primary" onclick="location.href='/admin/reports'">üìã Review Reports</button>
                  <button class="btn btn-ghost" onclick="location.href='/admin/users'">üë• Manage Users</button>
                  <button class="btn btn-ghost" onclick="location.href='/admin/settings'">‚öôÔ∏è System Settings</button>
                  <button class="btn btn-ghost" onclick="exportData()">üìä Export Data</button>
                </div>
              </div>

              <div class="chart-card">
                <h3 class="chart-title">System Status</h3>
                <div class="system-status">
                  <div class="status-item">
                    <span class="status-label">Database</span>
                    <div class="status-indicator online"></div>
                  </div>
                  <div class="status-item">
                    <span class="status-label">API Server</span>
                    <div class="status-indicator online"></div>
                  </div>
                  <div class="status-item">
                    <span class="status-label">Email Service</span>
                    <div class="status-indicator warning"></div>
                  </div>
                  <div class="status-item">
                    <span class="status-label">File Storage</span>
                    <div class="status-indicator online"></div>
                  </div>
                </div>
              </div>
            </div>
          </section>

           {{!-- Recent reports moved to /admin/reports. Recent users remains hidden. --}}
           </div>
         </div>
       </main>
     </div>
   </div>
   
   <!-- Footer -->
   <footer class="footer">
     <div class="footer-content">
       <div class="footer-section">
         <h4>CivicConnect Admin</h4>
         <p>Empowering civic engagement through technology</p>
         <div class="social-links">
           <a href="#" class="social-link">üìß</a>
           <a href="#" class="social-link">üì±</a>
           <a href="#" class="social-link">üåê</a>
         </div>
       </div>
       <div class="footer-section">
         <h5>Quick Links</h5>
         <ul class="footer-links">
           <li><a href="/admin">Dashboard</a></li>
           <li><a href="/admin/reports">Reports</a></li>
           <li><a href="/admin/users">Users</a></li>
           <li><a href="/admin/settings">Settings</a></li>
         </ul>
       </div>
       <div class="footer-section">
         <h5>Support</h5>
         <ul class="footer-links">
           <li><a href="#">Documentation</a></li>
           <li><a href="#">Help Center</a></li>
           <li><a href="#">Contact Support</a></li>
           <li><a href="#">System Status</a></li>
         </ul>
       </div>
       <div class="footer-section">
         <h5>System Info</h5>
         <div class="system-info">
           <div class="info-item">
             <span class="label">Version:</span>
             <span class="value">v2.1.0</span>
           </div>
           <div class="info-item">
             <span class="label">Status:</span>
             <span class="value online">‚óè Online</span>
           </div>
           <div class="info-item">
             <span class="label">Last Updated:</span>
             <span class="value">{{formatDate new Date}}</span>
           </div>
         </div>
       </div>
     </div>
     <div class="footer-bottom">
       <div class="footer-bottom-content">
         <p>&copy; 2024 CivicConnect. All rights reserved.</p>
         <div class="footer-bottom-links">
           <a href="#">Privacy Policy</a>
           <a href="#">Terms of Service</a>
           <a href="#">Cookie Policy</a>
         </div>
       </div>
     </div>
   </footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<script>
  (function(){
    if (!window.Chart) return;
    const accent = '#06b6d4';
    const accent2 = '#0ea5a4';

     const ctx1 = document.getElementById('trendChart');
     if (ctx1) {
       const labels = {{#if trendLabels}}{{{trendLabels}}}{{else}}["W1","W2","W3","W4","W5","W6","W7","W8","W9","W10","W11","W12"]{{/if}};
       const data = {{#if trendData}}{{{trendData}}}{{else}}[28,32,30,38,35,40,44,43,39,42,47,50]{{/if}};
       new Chart(ctx1, {
         type: 'line',
         data: { labels, datasets: [{ label: 'Incidents', data, borderColor: accent, backgroundColor: 'rgba(6,182,212,0.15)', fill: true, tension: 0.35, borderWidth: 2 }]},
         options: { 
           responsive: true,
           maintainAspectRatio: false,
           plugins: { legend: { display: false }}, 
           scales: { 
             x: { grid: { display:false }}, 
             y: { grid: { color: 'rgba(15,23,42,0.06)'}}
           }
         }
       });
     }

     const ctx2 = document.getElementById('slaChart');
     if (ctx2) {
       const compliant = {{#if slaCompliant}}{{slaCompliant}}{{else}}92{{/if}}; const breach = {{#if slaBreach}}{{slaBreach}}{{else}}8{{/if}};
       new Chart(ctx2, {
         type: 'doughnut',
         data: { labels: ['Compliant','Breach'], datasets: [{ data: [compliant, breach], backgroundColor: [accent2, '#fde68a'], borderWidth: 0 }]},
         options: { 
           responsive: true,
           maintainAspectRatio: false,
           plugins: { legend: { position: 'bottom' }}, 
           cutout: '65%'
         }
       });
     }

     const ctx3 = document.getElementById('statusChart');
     if (ctx3) {
       new Chart(ctx3, {
         type: 'bar',
         data: {
           labels: {{#if statusLabels}}{{{statusLabels}}}{{else}}["open","in_progress","resolved"]{{/if}},
           datasets: [{ label: 'Count', data: {{#if statusData}}{{{statusData}}}{{else}}[18,11,27]{{/if}}, backgroundColor: ['#bae6fd','#fde68a','#bbf7d0'], borderWidth: 0 }]
         },
         options: { 
           responsive: true,
           maintainAspectRatio: false,
           plugins: { legend: { display: false }}, 
           scales: { y: { beginAtZero: true }}
         }
       });
     }

     const ctx4 = document.getElementById('categoryChart');
     if (ctx4) {
       new Chart(ctx4, {
         type: 'polarArea',
         data: {
           labels: {{#if categoryLabels}}{{{categoryLabels}}}{{else}}["Roads","Water","Electricity","Sanitation"]{{/if}},
           datasets: [{ data: {{#if categoryData}}{{{categoryData}}}{{else}}[35,22,18,15]{{/if}}, backgroundColor: ['#bae6fd','#bbf7d0','#fecaca','#fde68a'], borderWidth: 0 }]
         },
         options: { 
           responsive: true,
           maintainAspectRatio: false,
           plugins: { legend: { position: 'bottom' }}
         }
       });
     }
  })();

  // Additional admin functions
  function exportData() {
    // Simulate data export
    const data = {
      users: {{usersCount}},
      reports: {{reportsCount}},
      open: {{openCount}},
      resolved: {{resolvedCount}},
      timestamp: new Date().toISOString()
    };
    
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `civicconnect-data-${new Date().toISOString().split('T')[0]}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    // Show notification
    showNotification('Data exported successfully!', 'success');
  }

  function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.style.cssText = `
      position: fixed; top: 20px; right: 20px; z-index: 1000;
      padding: 12px 20px; border-radius: 8px; color: white;
      font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      background: ${type === 'success' ? '#10b981' : type === 'warning' ? '#f59e0b' : '#3b82f6'};
      animation: slideIn 0.3s ease-out;
    `;
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.animation = 'slideOut 0.3s ease-in';
      setTimeout(() => document.body.removeChild(notification), 300);
    }, 3000);
  }

  // Add CSS for notifications
  const style = document.createElement('style');
  style.textContent = `
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideOut {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(100%); opacity: 0; }
    }
  `;
  document.head.appendChild(style);

  // Real-time updates simulation
  setInterval(() => {
    // Update notification badge
    const badge = document.querySelector('.bell-badge');
    if (badge) {
      const current = parseInt(badge.textContent);
      badge.textContent = Math.max(0, current + (Math.random() > 0.7 ? 1 : 0));
    }
    
    // Update activity feed
    const activities = [
      { icon: 'success', title: 'New report submitted', meta: 'Road issue in downtown area', time: 'just now' },
      { icon: 'warning', title: 'System alert', meta: 'High memory usage detected', time: '1 min ago' },
      { icon: 'info', title: 'User login', meta: 'admin@civicconnect.com', time: '2 mins ago' }
    ];
    
    if (Math.random() > 0.8) {
      const activity = activities[Math.floor(Math.random() * activities.length)];
      addActivityItem(activity);
    }
  }, 10000);

  function addActivityItem(activity) {
    const feed = document.querySelector('.activity-feed');
    if (!feed) return;
    
    const item = document.createElement('div');
    item.className = 'activity-item';
    item.innerHTML = `
      <div class="activity-icon ${activity.icon}">${activity.icon === 'success' ? '‚úì' : activity.icon === 'warning' ? '‚ö†' : activity.icon === 'danger' ? '!' : '‚Ñπ'}</div>
      <div class="activity-content">
        <div class="activity-title">${activity.title}</div>
        <div class="activity-meta">${activity.meta}</div>
        <div class="activity-time">${activity.time}</div>
      </div>
    `;
    
    feed.insertBefore(item, feed.firstChild);
    
    // Remove oldest items if more than 10
    while (feed.children.length > 10) {
      feed.removeChild(feed.lastChild);
    }
  }

  // Notification functions
  function toggleNotifications() {
    const dropdown = document.getElementById('notificationsDropdown');
    if (dropdown) {
      dropdown.classList.toggle('show');
    }
  }

  function markAsRead(button) {
    const notificationItem = button.closest('.notification-item');
    if (notificationItem) {
      notificationItem.classList.remove('unread');
      updateNotificationBadge();
    }
  }

  function markAllAsRead() {
    const unreadItems = document.querySelectorAll('.notification-item.unread');
    unreadItems.forEach(item => {
      item.classList.remove('unread');
    });
    updateNotificationBadge();
    showNotification('All notifications marked as read', 'success');
  }

  function clearAllNotifications() {
    const notificationsList = document.querySelector('.notifications-list');
    if (notificationsList) {
      notificationsList.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--muted);">No notifications</div>';
      updateNotificationBadge();
      showNotification('All notifications cleared', 'info');
    }
  }

  function handleNotificationClick(notificationItem, type) {
    // Mark as read when clicked
    notificationItem.classList.remove('unread');
    updateNotificationBadge();
    
    // Handle different notification types
    switch(type) {
      case 'report':
        showNotification('Redirecting to reports...', 'info');
        setTimeout(() => location.href = '/admin/reports', 500);
        break;
      case 'user':
        showNotification('Redirecting to users...', 'info');
        setTimeout(() => location.href = '/admin/users', 500);
        break;
      case 'system':
        showNotification('Redirecting to system status...', 'info');
        break;
      default:
        showNotification('Notification clicked', 'info');
    }
  }

  function viewReport(reportId) {
    showNotification(`Opening report #${reportId}...`, 'info');
    setTimeout(() => location.href = `/admin/reports?id=${reportId}`, 500);
  }

  function viewUser(username) {
    showNotification(`Opening user profile for ${username}...`, 'info');
    setTimeout(() => location.href = `/admin/users?user=${username}`, 500);
  }

  function viewSystemStatus() {
    showNotification('Opening system status...', 'info');
    // Could redirect to a system status page
  }

  function updateNotificationBadge() {
    const badge = document.querySelector('.bell-badge');
    const unreadCount = document.querySelectorAll('.notification-item.unread').length;
    if (badge) {
      badge.textContent = unreadCount;
      badge.style.display = unreadCount > 0 ? 'flex' : 'none';
    }
  }

  // Close notifications when clicking outside
  document.addEventListener('click', function(event) {
    const notifications = document.querySelector('.notifications');
    const dropdown = document.getElementById('notificationsDropdown');
    
    if (notifications && dropdown && !notifications.contains(event.target)) {
      dropdown.classList.remove('show');
    }
  });

  // Initialize real-time features
  document.addEventListener('DOMContentLoaded', function() {
    // Initialize notification badge
    updateNotificationBadge();
    
    // Add click handlers for notifications
    const bell = document.querySelector('.bell');
    if (bell) {
      bell.addEventListener('click', function(e) {
        e.stopPropagation();
        toggleNotifications();
      });
    }
  });
  </script>
</body>
</html>
