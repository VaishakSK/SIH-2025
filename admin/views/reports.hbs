<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reports - CivicSense Admin</title>
  <style>
    :root{ --bg-1:#0f172a; --muted:#94a3b8; --radius:14px }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Helvetica,Arial;background:
      radial-gradient(1200px 400px at 10% 10%, rgba(6,182,212,0.04), transparent),
      linear-gradient(180deg,#f5f7fb,#eef2f6);color:var(--bg-1)}
    .wrap{padding:20px}
    .panel{padding:16px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.98),#fff);box-shadow:0 12px 30px rgba(2,6,23,0.04);border:1px solid rgba(15,23,42,0.03)}
    .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
    .sub{color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
    .card{position:relative;border-radius:12px;overflow:hidden;background:#fff;border:1px solid rgba(15,23,42,0.06);box-shadow:0 10px 24px rgba(2,6,23,0.06)}
    .card img{width:100%;height:150px;object-fit:cover;display:block}
    .card-body{padding:10px}
    .chip{position:absolute;top:8px;left:8px;padding:6px 10px;border-radius:999px;background:#0ea5a4;color:#fff;font-weight:900;font-size:12px}
    .meta{display:flex;justify-content:space-between;align-items:center}
    .name{font-weight:800}
    .status{padding:4px 8px;border-radius:999px;background:#f0f9ff;color:#075985;font-weight:800;font-size:12px}
    .open{margin-top:8px;display:inline-block;padding:8px 10px;border-radius:10px;background:#06b6d4;color:#fff;text-decoration:none;font-weight:800}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <div class="header">
        <div>
          <h2 style="margin:0">Recent reports</h2>
          <div class="sub">Latest submissions across the city</div>
        </div>
      </div>
      <div class="grid">
        {{#if recentReports}}
          {{#each recentReports}}
            <div class="card">
              <span class="chip">#{{#if this.reportId}}{{this.reportId}}{{else if this.ticket}}{{this.ticket}}{{else}}{{this._id}}{{/if}}</span>
              {{#if this.isSample}}
                <img src="{{imageSrc this.imagePath this.imageUrl this.photo}}" alt="report" onerror="this.onerror=null;this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjM0MCIgdmlld0JveD0iMCAwIDYwMCAzNDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI2MDAiIGhlaWdodD0iMzQwIiBmaWxsPSIjMDZiNmQ0Ii8+Cjx0ZXh0IHg9IjMwMCIgeT0iMTcwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iNDgiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7wn5K3PC90ZXh0Pgo8L3N2Zz4K'"/>
              {{else}}
                <img src="{{imageSrc this.imagePath this.imageUrl this.photo}}" alt="report"/>
              {{/if}}
              <div class="card-body">
                <div class="meta">
                  <div class="name">
                    {{#if this.firstName}}{{this.firstName}}
                    {{else}}
                      {{#if this.name}}{{this.name}}
                      {{else}}
                        {{#if this.user}}
                          {{#if this.user.firstName}}{{this.user.firstName}}{{else}}{{this.user}}{{/if}}
                        {{else}}Unknown{{/if}}
                      {{/if}}
                    {{/if}}
                  </div>
                  <span class="status">{{#if this.status}}{{this.status}}{{else}}pending{{/if}}</span>
                </div>
                <div class="sub" style="margin-top:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">{{#if this.locationText}}{{this.locationText}}{{else if this.address}}{{this.address}}{{else if this.location}}{{this.location}}{{else}}Location unavailable{{/if}}</div>
                <a class="open" href="/admin/reports/{{#if this._id}}{{this._id}}{{else if this.reportId}}{{this.reportId}}{{else}}{{this.ticket}}{{/if}}">Open</a>
              </div>
            </div>
          {{/each}}
        {{else}}
          <div class="sub">No recent reports.</div>
        {{/if}}
      </div>
    </div>
  </div>
</body>
</html>


